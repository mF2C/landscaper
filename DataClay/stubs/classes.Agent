# dataClay header
# This is a Stub, to be used for the user client
from dataclay import dclayMethod, DataClayObject

# Imports required by the following class

# Definition of dataClay object class: Agent
class Agent(DataClayObject):

    @dclayMethod(bw="int")
    def set_bandwidth_capacity(self, bw):
        self._check_cloud("Trying to set bandwidth capacity on a cloud agent")
        self.device.network_info.bandwidth_capacity = bw
    @dclayMethod(return_=None)
    def calculate_aggregation(self):
        """ Update own properties (to be defined) taking info from the agent (device, children, other aggregated info) """
        pass
    @dclayMethod(RAM="int")
    def set_shared_RAM_size(self, RAM):
        self._check_cloud("Trying to set shared RAM size on a cloud agent")
        self.device.sharing_model_info.shared_RAM_size = RAM
    @dclayMethod(return_=None, exception_message="str")
    def _check_cloud(self, exception_message):
        if self.is_cloud:
            raise RuntimeError(exception_message)
    @dclayMethod(address="str")
    def set_ethernet_address(self, address):
        self._check_cloud("Trying to set ethernet address on a cloud agent")
        self.device.network_info.ethernet_address = address
    @dclayMethod(return_="dict<str, dict>")
    def get_all_children_info(self):
        if self.is_leader or self.is_cloud:
            return {child.id: child.get_resource_info_as_dict() for child in self.children}
        else:
            raise RuntimeError("Trying to get children on a normal agent")
    @dclayMethod(info="str")
    def set_ethernet_info(self, info):
        self._check_cloud("Trying to set ethernet info on a cloud agent")
        self.device.network_info.ethernet_info = info
    @dclayMethod(info="str")
    def set_standard_info(self, info):
        self._check_cloud("Trying to set network standard info on a cloud agent")
        self.device.network_info.standard_info = info
    @dclayMethod(CPU="int")
    def set_shared_CPU_percent(self, CPU):
        self._check_cloud("Trying to set shared CPU percent on a cloud agent")
        self.device.sharing_model_info.shared_CPU_percent = CPU
    @dclayMethod(device_sec="bool")
    def set_device_security(self, device_sec):
        self._check_cloud("Trying to set device security on a cloud agent")
        self.device.security_info.device_security = device_sec
    @dclayMethod(multicloud="bool")
    def set_multicloud_federation(self, multicloud):
        self._check_cloud("Trying to set multicloud federation on a non-cloud agent")
        self.multicloud_federation = multicloud
    @dclayMethod(percent="int")
    def set_remaining_power_percent(self, percent):
        self._check_cloud("Trying to set remaining power percent on a cloud agent")
        self.device.dynamic_info.remaining_power_percent = percent
    @dclayMethod(component="model_mf2c.classes.Component")
    def add_attached_component(self, component):
        self._check_cloud("Trying to add an attached component to a cloud agent")
        self.device.attached_components.append(component)
    @dclayMethod(return_="list<model_mf2c.classes.Component>")
    def get_attached_component_info(self):
        self._check_cloud("Trying to get attached components on a cloud agent")
        return self.device.attached_components
    @dclayMethod(return_="bool")
    def get_multicloud_federation(self):
        self._check_cloud("Trying to get multicloud federation on a non-cloud agent")
        return self.multicloud_federation
    @dclayMethod(child="model_mf2c.classes.Agent")
    def remove_child(self, child):
        if self.is_leader or self.is_cloud:
            try:
                self.children.remove(child)
            except ValueError:
                pass
            self.aggregated_resource_info.calculate_aggregation()
        else:
            raise RuntimeError("Trying to remove a child from a normal agent")
    @dclayMethod(size="int")
    def set_available_RAM_size(self, size):
        self._check_cloud("Trying to set available RAM size on a cloud agent")
        self.device.dynamic_info.available_RAM_size = size
    @dclayMethod(io="str")
    def set_network_io(self, io):
        self._check_cloud("Trying to set network IO on a cloud agent")
        self.device.network_info.network_io = io
    @dclayMethod(size="int")
    def set_available_storage_size(self, size):
        self._check_cloud("Trying to set available storage size on a cloud agent")
        self.device.dynamic_info.available_storage_size = size
    @dclayMethod(child="model_mf2c.classes.Agent")
    def add_child(self, child):
        if self.is_leader or self.is_cloud:
            self.children.append(child)
            self.aggregated_resource_info.calculate_aggregation()
        else:
            raise RuntimeError("Trying to add a child to a normal agent")
    @dclayMethod(my_device="model_mf2c.classes.Device")
    def __init__(self, my_device):
        self.id = my_device.device_id #For the moment I assign the same id to the device and to the agent
        self.aggregated_resource_info = AggregatedResourceInfo(self) #AggregatedResourceInfo about the associated device
        self.device = my_device
        self.children = list()
        self.is_leader = False
        self.is_cloud = False
        self.multicloud_federation = False
    @dclayMethod(return_="list")
    def get_attached_component_info_as_list(self):
        self._check_cloud("Trying to get attached components on a cloud agent")
        ret = list()
        for comp in self.get_attached_component_info():
            ret.append(comp.to_dict())
        return ret
    @dclayMethod(beh_info="model_mf2c.classes.BehaviourInfo")
    def set_behaviour_info(self, beh_info):
        self._check_cloud("Trying to set behaviour info on a cloud agent")
        self.device.behaviour_info = beh_info
    @dclayMethod(return_="model_mf2c.classes.SharingModelInfo")
    def get_sharing_model_info(self):
        self._check_cloud("Trying to get sharing model info on a cloud agent")
        return self.device.sharing_model_info
    @dclayMethod(return_="model_mf2c.classes.SecurityInfo")
    def get_security_info(self):
        self._check_cloud("Trying to get security info on a cloud agent")
        return self.device.security_info
    @dclayMethod(component="model_mf2c.classes.Component")
    def remove_attached_component(self, component):
        self._check_cloud("Trying to remove an attached component from a cloud agent")
        try:
            self.device.attached_components.remove(component)
        except ValueError:
            pass
    @dclayMethod(sec_info="model_mf2c.classes.SecurityInfo")
    def set_security_info(self, sec_info):
        self._check_cloud("Trying to set security info on a cloud agent")
        self.device.security_info = sec_info
    @dclayMethod(obj='anything', property_name='str', value='anything', beforeUpdate='str', afterUpdate='str')
    def __setUpdate__(self, obj, property_name, value, beforeUpdate, afterUpdate):
        if beforeUpdate is not None:
            getattr(self, beforeUpdate)(property_name, value)
        object.__setattr__(obj, "%s%s" % ("_dataclay_property_", property_name), value)
        if afterUpdate is not None:
            getattr(self, afterUpdate)(property_name, value)
    @dclayMethod(child_id="str", return_= bool)
    def check_child_exists(self, child_id):
        if self.is_leader or self.is_cloud:
            return any((child.id == child_id for child in self.children))
        else:
            raise RuntimeError("Trying to check child on a normal agent")
    @dclayMethod(sharing_info="model_mf2c.classes.SharingModelInfo")
    def set_sharing_model_info(self, sharing_info):
        self._check_cloud("Trying to set sharing model info on a cloud agent")
        self.device.sharing_model_info = sharing_info
    @dclayMethod(bw="int")
    def set_shared_bandwidth_size(self, bw):
        self._check_cloud("Trying to set shared bandwidth size on a cloud agent")
        self.device.sharing_model_info.shared_bandwidth_size = bw
    @dclayMethod(percent="int")
    def set_available_RAM_percent(self, percent):
        self._check_cloud("Trying to set available RAM percent on a cloud agent")
        self.device.dynamic_info.available_RAM_percent = percent
    @dclayMethod(storage="int")
    def set_shared_storage_size(self, storage):
        self._check_cloud("Trying to set shared storage size on a cloud agent")
        self.device.sharing_model_info.shared_storage_size = storage
    @dclayMethod(return_="model_mf2c.classes.BehaviourInfo")
    def get_behaviour_info(self):
        self._check_cloud("Trying to get behaviour info on a cloud agent")
        return self.device.behaviour_info
    @dclayMethod(data="bool")
    def set_data_privacy(self, data):
        self._check_cloud("Trying to set data privacy on a cloud agent")
        self.device.security_info.data_privacy = data
    @dclayMethod(return_="dict")
    def get_resource_info_as_dict(self):
        self._check_cloud("Trying to get resource info on a cloud agent")
        ret = {"Owner": self.device.owner.name}
        ret.update(self.device.static_info.to_dict())
        ret.update(self.device.dynamic_info.to_dict())
        ret.update(self.device.network_info.to_dict())
        ret.update(self.device.behaviour_info.to_dict())
        ret.update(self.device.security_info.to_dict())
        return ret
    @dclayMethod(location="str")
    def set_location(self, location):
        self._check_cloud("Trying to set location on a cloud agent")
        self.device.dynamic_info.location = location
    @dclayMethod(leader="bool")
    def set_leader_capability(self, leader):
        self._check_cloud("Trying to set leader capability on a cloud agent")
        self.device.behaviour_info.leader_capable = leader
    @dclayMethod(percent="int")
    def set_available_storage_percent(self, percent):
        self._check_cloud("Trying to set available storage percent on a cloud agent")
        self.device.dynamic_info.available_storage_percent = percent
    @dclayMethod(mobile="bool")
    def set_mobility(self, mobile):
        self._check_cloud("Trying to set mobility info on a cloud agent")
        self.device.behaviour_info.mobile = mobile
    @dclayMethod(percent="int")
    def set_available_CPU_percent(self, percent):
        self._check_cloud("Trying to set available CPU percent on a cloud agent")
        self.device.dynamic_info.available_CPU_percent = percent
    @dclayMethod(return_="tuple<model_mf2c.classes.User, str, str, model_mf2c.classes.DynamicInfo>")
    def get_dynamic_info(self):
        self._check_cloud("Trying to get dynamic info on a cloud agent")
        return self.device.owner, self.device.static_info.operating_system, self.device.static_info.system_architecture, self.device.dynamic_info
    @dclayMethod(trust="str")
    def set_trust(self, trust):
        self._check_cloud("Trying to set trust info on a cloud agent")
        self.device.behaviour_info.trust = trust
    @dclayMethod(return_="model_mf2c.classes.NetworkInfo")
    def get_network_info(self):
        self._check_cloud("Trying to get network info on a cloud agent")
        return self.device.network_info
    @dclayMethod(return_="tuple<model_mf2c.classes.User, model_mf2c.classes.StaticInfo>")
    def get_static_info(self):
        self._check_cloud("Trying to get static info on a cloud agent")
        return self.device.owner, self.device.static_info
    @dclayMethod(seconds="int")
    def set_remaining_power_seconds(self, seconds):
        self._check_cloud("Trying to set remaining power seconds on a cloud agent")
        self.device.dynamic_info.remaining_power_seconds = seconds
    @dclayMethod(address="str")
    def set_wifi_address(self, address):
        self._check_cloud("Trying to set wifi address on a cloud agent")
        self.device.network_info.wifi_address = address
    @dclayMethod(reliability="str")
    def set_reliability(self, reliability):
        self._check_cloud("Trying to set reliability info on a cloud agent")
        self.device.behaviour_info.reliability = reliability
    @dclayMethod(network="bool")
    def set_network_security(self, network):
        self._check_cloud("Trying to set network security on a cloud agent")
        self.device.security_info.network_security = network
    @dclayMethod(return_="tuple<model_mf2c.classes.User, model_mf2c.classes.StaticInfo, model_mf2c.classes.DynamicInfo, model_mf2c.classes.NetworkInfo, model_mf2c.classes.BehaviourInfo, model_mf2c.classes.SecurityInfo>")
    def get_resource_info(self):
        self._check_cloud("Trying to get resource info on a cloud agent")
        self.device.behaviour_info, self.device.security_info
        return self.device.owner, self.device.static_info, self.device.dynamic_info, self.device.network_info, self.device.behaviour_info, self.device.security_info
    @dclayMethod(info="str")
    def set_wifi_info(self, info):
        self._check_cloud("Trying to set wifi info on a cloud agent")
        self.device.network_info.wifi_info = info
    pass
# End of class definition
